# トランプマスキュラー 引き継ぎノート

## 現状サマリー
- **UI構成**: TOP（通常/カスタムスタート）→ カスタマイズ → トレーニング → リザルトの静的構成。ビルドツールなしでそのままデプロイ可能。
- **カスタマイズ機能**: `sessionStorage` に最大レップ設定（20/30/40/50）を保存し、`web/deck.js` が設定に応じたデッキを生成。キングは常に13回。
- **トレーニング画面**:
  - 初回自動ドロー＆BGM再生を試み、カード毎に `change.mp3` を再生。
  - タイマーは「総トレ時間」「次のカードまで」を表示。カウント0で自動ドロー、完了後は自動リザルト遷移。
  - 途中経過ダイアログ表示中はタイマー/BGM/スペクトラムを一時停止し、閉じたら再開。
- **リザルト画面**: 総レップ、所要時間、デッキ構成、総カード枚数を表示。履歴はドロー順で記録。
- **テスト**: `ruby test/test_deck.rb` と `node test/deck.test.mjs`（deck生成の単体テスト）を追加。`package.json` で ESM を有効化。

## 未対応・検討事項
- 実機 iOS での BGM 自動再生はフォールバックを入れたが、確実ではないため引き続き確認が必要。
- React/TypeScript 化やネイティブアプリ対応は未着手。PWA 化など段階的アプローチが現実的。
- サウンドやガイド表示の強化、履歴の永続化（ローカル保存）などは今後のアイデアとして README に記載。

## 作業メモ
- `readme.png` を削除し、最新スクリーンショットは `img/` ディレクトリに格納。
- 旧 `SPEC.md` / `version_up.md` は削除済み。
- BGM 用 `<audio>` は `playsinline` 指定、初回操作時に再生リトライする仕組みあり。

## 直近で想定されるタスク例
1. iOS 実機での BGM 再生確認と追加対策（ユーザー操作デバッグログの追加など）。
2. PWA 対応（Service Worker / manifest）でモバイル利用を改善。
3. カスタムプリセットやセッション履歴保存の追加実装。

## ブランチについて
- サンドボックス制限で `git checkout -b feature/custom-session` が拒否されたため、ブランチ作成はできていません。必要ならローカル環境で改めてブランチを切ってください。
